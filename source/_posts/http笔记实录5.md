---
title: HTTP笔记实录5
categories:
- 技术
- HTTP      
tags:
- HTTP
---


### 第 5 章 与 HTTP 协作的 Web 服务器

一台 Web 服务器可搭建多个独立域名的 Web 网站， 也可作为通信路径上的中转服务器提升传输效率


#### 5.1 用单台虚拟主机实现多个域名

HTTP/1.1 规范允许一台 HTTP 服务器搭建多个 Web 站点。 比如， 提供 Web 托管服务（Web Hosting Service） 的供应商， 可以用一台服务器为多位客户服务， 也可以以每位客户持有的域名运行各自不同的网站。 这是因为利用了虚拟主机（Virtual Host， 又称虚拟服务器） 的功能。

即使物理层面只有一台服务器， 但只要使用虚拟主机的功能， 则可以假想已具有多台服务器。

在互联网上， 域名通过 DNS 服务映射到 IP 地址（域名解析） 之后访问目标网站。 可见， 当请求发送到服务器时， 已经是以 IP 地址形式访问了。


所以， 如果一台服务器内托管了 www.tricorder.jp 和 www.hackr.jp 这两个域名， 当收到请求时就需要弄清楚究竟要访问哪个域名。

![](https://ws1.sinaimg.cn/large/006c6oKBgy1fspgtq3lekj30ei08xwho.jpg)

在相同的 IP 地址下， 由于虚拟主机可以寄存多个不同主机名和域名的 Web 网站， 因此在发送 HTTP 请求时， 必须在 Host 首部内完整指
定主机名或域名的 URI。

<!--more-->
#### 5.2 通信数据转发程序 ： 代理、 网关、 隧道

HTTP 通信时， 除客户端和服务器以外， 还有一些用于通信数据转发的应用程序， 例如代理、 网关和隧道。 它们可以配合服务器工作。

这些应用程序和服务器可以将请求转发给通信线路上的下一站服务器， 并且能接收从那台服务器发送的响应再转发给客户端。

- 代理
代理是一种有转发功能的应用程序， 它扮演了位于服务器和客户端“中间人”的角色， 接收由客户端发送的请求并转发给服务器， 同时
也接收服务器返回的响应并转发给客户端。
代理不改变请求 URI， 会直接发送给前方持有资源的目标服务器
使用代理服务器的理由有： 利用缓存技术（稍后讲解） 减少网络带宽的流量， 组织内部针对特定网站的访问控制， 以获取访问日志为主要
目的， 等等。

- 网关
网关是转发其他服务器通信数据的服务器， 接收从客户端发送来的请求时， 它就像自己拥有资源的源服务器一样对请求进行处理。 有时客
户端可能都不会察觉， 自己的通信目标是一个网关。

利用网关能提高通信的安全性， 因为可以在客户端与网关之间的通信线路上加密以确保连接的安全。 比如， 网关可以连接数据库， 使用
SQL语句查询数据。 另外， 在 Web 购物网站上进行信用卡结算时，网关可以和信用卡结算系统联动

- 隧道
隧道是在相隔甚远的客户端和服务器两者之间进行中转， 并保持双方
通信连接的应用程序。


#### 5.3 保存资源的缓存

缓存是指代理服务器或客户端本地磁盘内保存的资源副本。 利用缓存可减少对源服务器的访问， 因此也就节省了通信流量和通信时间

##### 5.3.1 缓存的有效期限

当遇上源服务器上的资源更新时， 如果还是使用不变的缓存， 那就会演变成返回更新前的“旧”资源了。

即使存在缓存， 也会因为客户端的要求、 缓存的有效期等因素， 向源服务器确认资源的有效性。 若判断缓存失效， 缓存服务器将会再次从
源服务器上获取“新”资源。

![](https://ws1.sinaimg.cn/large/006c6oKBgy1fsph7qr89hj30hy09qtcp.jpg)

##### 5.3.2 客户端的缓存


缓存不仅可以存在于缓存服务器内， 还可以存在客户端浏览器中。 以Internet Explorer 程序为例， 把客户端缓存称为临时网络文件
（Temporary Internet File） 。
浏览器缓存如果有效， 就不必再向服务器请求相同的资源了， 可以直接从本地磁盘内读取